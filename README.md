# Rust WebAssembly Integration Example

This project demonstrates how to create, optimize, and integrate a Rust library compiled to WebAssembly (WASM) using `wasm-pack`. It provides robust implementations of SHA-256 hashing and prime number generation, complete with thorough documentation, error handling, and JavaScript integration examples.

## Project Structure

```
wasm_integration/
├── Cargo.toml
├── src/
│   └── lib.rs
├── pkg/ (generated by wasm-pack, move inside web/src/wasm/pkg)
└── web/
    ├── src/
    │   └── wasm/
    │   └── main.js
    ├── index.html
    ├── package.json
    └── vite.config.js
```

## Prerequisites

- Rust (edition 2021)
- [wasm-pack](https://github.com/rustwasm/wasm-pack)
- A modern web browser

## Installation

1. **Clone the repository**:

```bash
git clone https://github.com/mtfuji25/wasm-integration
cd wasm-integration
```

2. **Install wasm-pack**:

```bash
cargo install wasm-pack
```

## Building the Project

To compile the Rust code into optimized WebAssembly:

```bash
wasm-pack build --release --target web
```

The compiled WASM files will be generated in the `pkg/` directory.

## Running the Web Demo

Navigate to the web directory and start a local HTTP server (using vite):

```bash
cd web
yarn
yarn dev
```

Open your web browser and visit:

```
http://localhost:5173/
```

## Testing

This project uses `wasm-bindgen-test` to run tests in a WebAssembly-compatible environment. The tests verify that the exported functions (`compute_sha256` and `generate_primes`) behave as expected.

### Prerequisites

- **wasm-pack:** Ensure you have `wasm-pack` installed. If not, install it using:
  ```bash
  cargo install wasm-pack
  ```
- **Browser:** Headless Chrome or Firefox is required to run the tests in a browser environment.

### Running the Tests

Tests can be run using `wasm-pack test`. Here are two common options:

- **Run tests with Chrome (headless):**
  ```bash
  wasm-pack test --headless --chrome
  ```

- **Run tests with Firefox (headless):**
  ```bash
  wasm-pack test --headless --firefox
  ```

## Features

### SHA-256 Hashing
- Computes SHA-256 hashes from text input.
- Robust error handling for empty inputs.

### Prime Number Generation
- Generates primes using an optimized Sieve of Eratosthenes.
- Handles errors for invalid or overly large input values.

## Optimization & Profiling
- Link Time Optimization (`lto`) enabled.
- Minimized file size (`opt-level = "z"`).
- Profiling via browser developer tools recommended for further optimizations.

## Contributing

Contributions and improvements are welcome! Please open an issue or submit a pull request.

## License

This project is open-sourced under the MIT License. See the [LICENSE](LICENSE) file for details.

